# ============================================================
# Investigation of the Relationship Between Temperature and
# Traffic Volume in Chicago
#
# Author: Olivia M. Rueschhoff
# Advisor: Dr. Feridun Tasdan
#
# This script supports the statistical analysis presented in
# the accompanying paper. The goal is to explore the relationship
# between daily maximum temperature and traffic vehicle volume
# using descriptive statistics, distribution fitting, correlation
# analysis, and graphical methods.
#
# Data were originally compiled and cleaned in Excel and then
# imported into R for statistical analysis.
# ============================================================


# ------------------------------------------------------------
# Raw Data Vectors
# ------------------------------------------------------------
# temp: Daily maximum temperatures (°F)
# veh_vol: Daily traffic vehicle volume counts

temp=c(39,40,42,43,37,32,40,41,39,37,42,54,48,34,40,42,44,36,53,49,36,38,34,40,
36,43,49,50,50,40,39,39,39,44,33,33,37,33,31,32,36,35,30,37,54,45,40,27,10,19,
32,37,44,44,45,44,34,38,35,38,37,32,35,33,36,41,54,57,53,64,57,63,41,40,36,36,
35,38,35,33,44,43,38,41,44,50,42,50,69,71,49,59,56,58,52,54,53,42,51,70,74,77,
82,81,66,55,52,57,64,67,72,70,71,67,47,64,69,59,57,61,60,66,76,66,61,56,67,71,
73,73,62,48,52,57,57,60,75,58,57,75,54,57,69,75,77,69,81,93,89,90,75,70,71,69,
74,65,63,64,68,71,78,91,92,79,88,76,89,81,67,74,71,69,76,78,75,80,92,87,82,78,
75,76,80,85,89,74,77,76,80,84,92,94,95,80,85,81,78,79,80,89,92,87,84,88,93,90,
98,99,96,79,84,84,85,82,76,82,80,75,76,81,85,79,81,82,82,82,76,80,85,88,85,84,
80,77,72,69,74,74,73,74,77,70,75,76,85,84,73,65,68,73,67,72,76,80,85,72,56,64,
69,71,73,66,73,71,69,60,61,69,74,76,79,77,58,58,67,74,65,59,57,41,52,52,54,56,
58,63,46,54,61,50,43,49,53,48,47,53,55,70,63,43,35,42,48,54,54,53,65,67,49,43,
45,44,47,47,44,43,45,43,43,49,54,52,60,60,62,62,62,62,42,36,34,20,28,35,38,23,
24,38,43,47,51,48,52,47,56,56,45,45,41,44,53,42,46,39,36,40,48,46,50,57)

veh_vol=c(13700,21700,16500,16700,18200,14600,11800,15500,21600,11100,18300,
7000,19100,20900,22400,17800,14200,13200,4400,15300,8100,7900,12300,14800,
6000,7900,16600,20600,6100,12500,14500,13000,8100,8000,15600,18800,7400,4500,
10000,9000,10500,10100,12700,7100,8300,16100,11800,18200,23400,21200,15100,
4900,13300,4900,27800,13400,14600,5300,8600,5300,10900,43500,5900,47900,5500,
17300,3600,16400,14900,35100,4200,19900,26300,27300,30800,23500,25600,61500,
31800,12500,52500,27800,25500,72900,8100,28800,13600,33200,12800,15000,14800,
13500,26300,16300,38300,16700,5300,13400,18000,15600,5000,27100,15300,30900,
13700,12800,4200,35000,7900,29300,12500,11300,38700,13200,29100,29500,22000,
23000,4200,22600,18600,35300,25500,29900,32100,5400,17800,38700,40500,20100,
19400,2600,12100,15600,6700,29500,35700,3500,5500,7700,18400,21300,2000,
11800,39100,8300,36600,6600,11000,11300,8600,9000,10700,10800,15400,31600,
6900,13400,6500,32900,19100,33300,8000,7800,11100,11400,11700,10300,10100,
4800,10600,2900,28200,19200,12500,18700,13400,11900,8600,30400,18000,8900,
15100,17600,20700,14100,28600,16800,39500,12400,8800,17600,33900,7300,11100,
16300,14900,12500,9300,17600,21700,12600,12300,16100,5900,15800,16700,8000,
18100,2300,17300,13600,15300,13100,6600,4900,18000,9200,31600,5300,1300,16300,
24600,6100,18100,9600,15200,21200,8900,12400,4800,16000,10200,700,10800,10200,
13700,8500,5200,8200,13400,6700,10000,10700,18100,11500,165200,111600,31600,
15400,41300,8900,19900,19500,7200,6800,17000,15300,14400,14700,9800,17300,
15900,28200,14000,3800,8800,8100,12400,11000,5600,10500,6400,7900,37900,15000,
33800,8800,9700,9100,7400,14200,16800,8500,15700,14700,14700,22800,9400,19900,
17200,16300,19300,3000,18100,8900,8300,23100,7300,7500,7200,21500,9100,7400,
5500,18900,15800,11500,2500,5000,24300,11000,12800,16100,8100,41300,23700,
33200,6800,17200,19300,7700,1800,13800,8200,28500,12300,20100,3200,9600,6200,
7000,16700,11700,28000,23900,20300,22700,4200,38500,12600,46500,71200,21900,25900,
19900,22700,18000,31500,21000,18200,27100,26600,16800,16800,27100,24200,30600,
27600,23800,23900,17700,21800,24300,21700,28900,23700,17200,21600,23000,9700,
32800,30500,17800,14600,22400,25400,18200,29200,22300,22600,20200,18700,15900,
26300,24600,18500,23600,11100,20700,27000,22200,29800,22900,15600,33100,19800,
34600,17500,19100,26100,32000,25200,36900,52300,22200,33700,23500,32700,11600,
23700,27500,22600,21300,12800,33300,60400,26800,17700,16100,20200,46600,19300,
24000,16400,45700,56700,35600,13900,12900,16600,13000,37900,24400,19200,14300,
16700,38300,31400,21000,16300,31800,12100,18200,17000,19300,33600,20300,25300,
22500,18500,40700,24600,34100,32100,24400,15600,21500,30800,29400,24000,25800,
43900,37900,12200,22100,14000,49400,27600,37100,24700,40600,15900,4200,25300,
30300,19200,34400,23400,37400,18600,24100,26700,23600,22600,18300,18000,23600,
25600,17500,22000,22700,44000,38300,18800,15500,34700,41500,12600,16800,17600,
10200,34600,19000,16900,10400,14300,14100,34000,19600,19600,20200,20800,9900,
20700,32900,22000,7100,18100,23900,14400,26700,11400,11400,19900,24900,25800,
19500,7000,27600,53500,28600,25000,47900,81100,19900,41200,34300,16900,40900,
6700,7900,20200,2000,14700,41200,34500,5400,44700,32100,25900,13300,24200,
23600,20800,37100,35300,25000,31000,4800,4200,33400,8000,32100,9100,11700,
14400,3100,25700,28700,12200,33000,5300,16500,10900,7500,37400,11500,40200,
28100,25100,29800,12200,12500,33800,6900,13000,12800,4200,42100,22200,31800,
20000,4700,30300,26200,7800,8900,6300,31700,42500,35700,30700,18600,39200,16700,
45300,35000,34400,38100,17500,5700,18700,8200,24700,29200,36100,15300,10600,
21000,12500,11400,25900,37700,19400,7600,19500,19800,19300,14300,11900,8000,
10800,41600,21700,23300,9600,15700,24000,8400,19200,28700,27400,58100,17300,
20200,63700,9100,18800,2900,14200,17700,5100,3200,19500,21500,18800,18000,10300,
9500,18400,20100,2000,20600,29500,18900,14100,19000,7600,4700,8900,23100,21100,
14800,17800,6500,15500,9500,27600,12200,9900,37000,4900,10400,18500,8800,14700,
7400,8600,11500,15800,34200,9900,10500,3500,18000,21200,19900,5100,14500,10900,
17700,18200,10600,13000,16300,12100,31400,24200,11600,16100,9600,32000,7800,
23000,18500,18500,16500,10500,11700,16800,17900,13000,17400,9400,10200,13800,
21600,10800,16500,14400,17900,7400,16000,4400,16400,15100,103100,13500,16400,
14300,20400,5200,53400,32300,37700,18800,42800,2800,26900,32800,19000,25800,
18700,37800,32700,18200,22100,10000,2000,7700,26800,8400,19800,12300,39000,
22800,16200,21100,11000,17000,9200,7800,10600,33100,18400,7500,14100,14300,
39000,10700,12700,12700,12300,19700,5800,11600,14600,10700,19000,20700,12600,
17300,72400,62700,15000,15500,8900,15700,14100,76700,11300,17600,10100,21200,
14300,14500,7900,40000,22800,11900,11600,7300,15600,4500,13700,8300,12600,39400,
20400,9700,11500,15000,20000,8800,9100,7300,20300,18100,11900,17100,11200,21500,
6300,11500,12100,20300,23800,14000,24400,19600,6800,24100,4700,1200,23700,6300,13700,33800,
23900,3900,13900,34300,24200,5700,24800,9500,6700,13100,22700,800,11600,23700,
29000,23500,10700,4500,8200,3500,6000,6000,9300,4900,5900,32400,3400,22700,7000,
5500,10500,25000,3800,27300,6000,6600,21300,6800,12200,11900,22100,17400,18400,
16100,19600,10500,14500,20000,20500,21400,15500,14900,16100,5100,16300,12300,
13100,26800,20000,21500,25000,20400,39400,17300,11300,23300,20500,9900,14000,
12400,14900,4200,23700,38500,14300,15400,8800,33300,13100,18200,26000,40600,
37400,10800,35200,20300,16600,44000,25700,36600,24800,12300,4500,13200,16600,
10300,12400,10700,19900,12500,7600,12500,15600,24700,3900,15500,10700,21200,
18700,19200,14700,39900,9500,23800,38600,19500,20900,10600,25300,8600,23100,
28000,24400,24200,22100,26200,37800,18700,47300,13700,27500,20800,11700,10100,
19400,32700,9000,2400,43100,31600,22500,33900,22400,20900,11200,11100,25700,
8700,8400,13700,19600,27300,8600,39500,6300,23700,14100,34900,13000,13300,
20900,8600,24500,16600,36500,11700,9700,18900,11100,12400,17400,11400,18200,
25400,26600,24800,19500,37300,18900,16500,13100,16100,16000,11500,10200,6600,
23100,8500,17100,13000,41700,18200,18800,14500,34100,14500,6800,12800,7700,
16600,21800,25500,6900,26800,14300,6900,21700,10800,13100,15300,23900,18300,
7700,16100,9700,9000,36700,8600,19800,22600,28900,10500,9300,21400,20300,
11800,11400,5000,14400,20600,14600,21700,56800,15700,18400,33700,15000,15900,
21100,19600,17300,19700,67200,12500,15500,12800,22800,15900,14800,16700,12500,
59900,37000,18400,18800,19500,21900,11100,33900,32100,34400,31800,9900,6500,
23600,13500,14200,16400,16700,23700,10400,16200,18800,22200,37700,13000,21700,
16000,28900,42200,19200,21200,24200,13000,17100,22700,21300,25300,32100,33000,
27200,26100,32200,17600,43000,20000,30500,24900,35200,24800,13000,21300,14400,
25000,8900,38700,26000,20300,22100,20400,31500,14100,13800,59100,33500,25400,
16800,13400,14500,10700,23400,35100,6000,6300,36000,41900,15800,8300,19300,
18800,70900,6400,26200,29900,16300,20700,30100,8200,20100,14200,46500,4600,
29900,13200,44000,24200,21800,15200,18500,16800,23600,18700,16200,23000,4400,
17700,2100,15100,30200,14500,29800,22700,7600,8800,22300,13200,11900,5700,
29300,16900,9400,18800,23800,7100,15600,23200,8000,30400,9800,24100,11300,21600,
5900,16400,8600,14100,33200,30300,8900,10300,20000,16500,26500,17400,39400,
6500,16300,19200,6500,20500,35500,16400,20500,19300,12200,21600,14800,13800,
13500,23800,17400,11300,23900,23200,15000,16600,13400,53800,21400,32500,36000)

# ------------------------------------------------------------
# Load Required Libraries
# ------------------------------------------------------------
# fitdistrplus: Used for descriptive distribution analysis
# dgof: Used for Kolmogorov–Smirnov goodness-of-fit testing

library(fitdistrplus)

# ------------------------------------------------------------
# Distribution Diagnostics: Temperature
# ------------------------------------------------------------
# Cullen and Frey graph and summary statistics are used to
# evaluate skewness, kurtosis, and potential distribution families.

descdist(temp, discrete = FALSE)

# Summary (from output):
# Min: 10, Max: 99
# Mean: 59.54
# Median: 58
# Skewness near 0 suggests approximate symmetry
# Kurtosis near 2 suggests flatter-than-normal distribution


# ------------------------------------------------------------
# Distribution Diagnostics: Vehicle Volume
# ------------------------------------------------------------
# Vehicle volume data are assessed for skewness and heavy tails.

descdist(veh_vol, discrete = FALSE)


# ------------------------------------------------------------
# Normal Distribution Fitting
# ------------------------------------------------------------
# A normal distribution is fitted to each variable to evaluate
# goodness-of-fit and visual alignment with empirical data.

normal_dist1 = fitdist(temp, "norm")
plot(normal_dist1)

normal_dist2 = fitdist(veh_vol, "norm")
plot(normal_dist2)


# ------------------------------------------------------------
# Kolmogorov–Smirnov Test Preparation
# ------------------------------------------------------------
# The dgof package is used to compare empirical distributions
# between temperature and traffic volume after data adjustments.

install.packages("dgof")
library(dgof)


# ------------------------------------------------------------
# Empirical CDF Comparison
# ------------------------------------------------------------
# Visual comparison of empirical cumulative distribution functions
# for temperature and vehicle volume.

plot(ecdf(temp2),
     xlim = range(c(temp2, veh_vol2)),
     col = "blue")

plot(ecdf(veh_vol2),
     add = TRUE,
     lty = "dashed",
     col = "red")


# ------------------------------------------------------------
# Kolmogorov–Smirnov Test
# ------------------------------------------------------------
# Tests whether the two samples come from the same distribution.

ks.test(temp2, veh_vol2)


# ------------------------------------------------------------
# Grouped / Cleaned Data
# ------------------------------------------------------------
# temp2 and veh_vol2 represent processed versions of the data
# used for further correlation and visualization analyses.

temp2 = c(39,39,35,35,35,35,35,35,35,35,35,38,38,38,38,38,38,37,37,37,37,37,37,
37,37,37,37,37,37,37,37,37,37,37,37,37,41,41,41,41,41,41,41,41,41,41,54,54,54,54,
54,54,54,54,54,54,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,41,41,41,41,41,41,
41,41,41,41,41,41,40,40,40,40,40,40,40,33,33,33,33,33,33,33,33,33,33,33,33,33,
33,33,33,33,33,33,33,33,33,33,44,44,44,44,44,44,44,44,44,44,44,44,44,44,43,43,
43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,42,42,42,42,42,42,
42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,
42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,
42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,50,50,50,50,50,50,50,50,50,50,69,
69,69,69,69,69,69,69,69,69,69,69,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,
47,47,47,64,64,64,64,64,64,64,64,64,64,69,69,69,69,69,69,69,69,69,69,69,69,69,
69,69,69,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,
66,66,66,66,66,66,66,66,66,66,61,71,73,73,73,73,73,73,73,73,73,73,73,62,62,87,
96,76,76,76,76,82,82,82,82,82,82,82,82,82,80,80,80,80,80,80,80,80,80,80,80,80,
80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,85,85,85,85,85,85,85,
79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,
79,79,79,79,79,79,79,79,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,
81,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,
82,82,82,82,82,76,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,
85,85,85,85,85,85,85,85,85,85,85,85,85,85,88,88,88,88,88,88,88,88,88,88,88,88,
88,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,
85,85,85,84,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,
69,69,69,69,69,69,69,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,
74,73,75,75,75,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,73,73,
73,73,73,73,73,73,73,73,73,73,73,73,73,72,72,72,72,72,72,72,72,72,72,72,72,72,
72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,56,56,56,56,56,56,56,56,56,56,
56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,
56,56,56,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,
64,64,64,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,
69,69,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,69,69,69,69,69,
69,69,69,69,69,69,69,60,60,60,60,60,60,60,60,60,60,76,76,76,76,76,76,76,76,76,
76,76,76,76,76,76,76,76,79,79,79,79,79,79,79,79,77,77,77,77,77,77,77,77,77,77,
77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,58,58,58,58,58,58,
58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,65,65,65,65,65,65,65,65,65,65,65,
65,65,65,65,65,59,59,59,59,59,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,
57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,41,41,41,41,41,41,41,41,
41,41,41,41,41,41,52,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,
56,56,56,56,56,56,56,56,56,58,58,58,58,58,58,58,58,58,58,58,58,58,63,63,63,63,
63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,
63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,46,46,46,
46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,43,43,
43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,49,49,
49,49,49,49,49,49,49,49,49,49,49,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,
53,53,53,53,53,53,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
48,70,70,63,63,63,63,63,63,63,63,63,63,63,63,63,43,43,43,35,35,35,35,53,53,53,
53,53,53,53,53,53,53,53,53,53,53,65,65,65,65,65,65,65,65,67,67,67,44,44,44,44,
44,44,44,44,44,44,44,44,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,
47,47,47,47,47,47,47,47,47,47,47,47,47,47,44,44,44,44,44,44,44,43,47,47,47,48,
45,45,41,41)


veh_vol2 = c(13700, 21700, 16500,16700,18200,14600,11800,15500,21600,11100,18300,
7000,19100,20900,22400,17800,14200,13200,4400,15300,8100,7900,12300,14800,6000,
7900,16600,20600,6100,12500,14500,13000,8100,8000,15600,18800,7400,4500,10000,9000,
10500,12700,7100,8300,16100,11800,18200,23400,21200,15100,4900,27800,13400,14600,5300,
8600,5300,10900,43500,5900,47900,5500,17300,3600,16400,14900,35100,4200,19900,
26300,27300,30800,23500,25600,31800,12500,52500,27800,25500,72900,8100,28800,
13600,33200,12800,15000,14800,13500,26300,16300,38300,16700,5300,13400,18000,
15600,5000,27100,15300,30900,13700,12800,4200,35000,37900,29300,12500,11300,
38700,13200,29100,29500,22000,23000,4200,22600,18600,35300,25500,29900,32100,
5400,17800,38700,40500,20100,19400,2600,12100,15600,6700,29500,35700,3500,5500,
7700,18400,21300,2000,11800,39100,8300,36600,6600,11000,11300,8600,9000,10700,
10800,15400,31600,6900,13400,6500,32900,19100,33300,8000,7800,11100,11400,11700,
10300,10100,4800,10600,2900,28200,19200,12500,18700,13400,11900,8600,30400,
18000,8900,15100,17600,20700,14100,28600,16800,39500,12400,8800,17600,33900,
7300,11100,16300,14900,12500,9300,17600,21700,12600,12300,16100,5900,15800,
16700,8000,18100,2300,17300,13600,15300,13100,6600,4900,18000,9200,31600,5300,
1300,16300,24600,6100,18100,9600,15200,21200,8900,12400,4800,16000,10200,10800,
10200,13700,8500,5200,8200,13400,6700,10000,10700,18100,11500,31600,15400,
41300,8900,19900,19500,7200,6800,17000,15300,14400,14700,9800,17300,15900,
28200,14000,3800,8800,8100,12400,11000,5600,10500,6400,7900,37900,15000,33800,
8800,9700,9100,7400,14200,16800,8500,15700,14700,14700,22800,9400,19900,17200,
16300,19300,3000,18100,8900,8300,23100,7300,7500,7200,21500,9100,7400,5500,
18900,15800,11500,2500,5000,24300,11000,12800,16100,8100,41300,23700,33200,
6800,17200,19300,7700,1800,13800,8200,28500,12300,20100,3200,9600,6200,7000,
16700,11700,28000,23900,20300,22700,4200,38500,12600,71200,21900,25900,19900,
22700,18000,31500,21000,18200,27100,26600,16800,16800,27100,24200,30600,27600,
23800,23900,17700,21800,24300,21700,28900,23700,17200,21600,23000,9700,32800,
30500,17800,14600,22400,25400,18200,29200,22300,22600,20200,18700,15900,26300,
24600,18500,23600,11100,20700,27000,22200,29800,22900,15600,33100,19800,34600,
17500,19100,26100,32000,25200,36900,22200,33700,23500,32700,11600,23700,27500,
22600,21300,12800,33300,60400,26800,17700,16100,20200,46600,19300,24000,16400,
45700,35600,13900,12900,16600,13000,37900,24400,19200,14300,16700,38300,31400,
21000,16300,31800,12100,18200,17000,19300,33600,20300,25300,22500,18500,40700,
24600,34100,32100,24400,15600,21500,30800,29400,24000,25800,37900,12200,22100,
14000,27600,37100,24700,40600,15900,4200,25300,30300,19200,34400,23400,37400,
18600,24100,26700,23600,22600,18300,18000,23600,25600,17500,22000,22700,44000,
38300,18800,15500,34700,41500,12600,16800,17600,10200,34600,19000,16900,10400,
14300,14100,34000,19600,19600,20200,20800,9900,20700,32900,22000,7100,18100,
23900,14400,26700,11400,11400,19900,24900,25800,19500,7000,27600,53500,28600,
25000,47900,19900,41200,34300,16900,40900,6700,7900,20200,2000,14700,41200,
34500,5400,44700,32100,25900,13300,24200,23600,20800,37100,35300,25000,31000,
4800,4200,33400,8000,32100,9100,11700,14400,3100,25700,28700,12200,33000,5300,
16500,10900,7500,37400,11500,40200,28100,25100,29800,12200,12500,33800,6900,
13000,12800,4200,42100,22200,31800,20000,4700,30300,26200,7800,8900,6300,31700,
42500,35700,30700,18600,39200,16700,45300,35000,34400,38100,17500,5700,18700,
8200,24700,29200,36100,15300,10600,21000,12500,11400,25900,37700,19400,7600,
19500,19800,19300,14300,11900,8000,10800,41600,21700,23300,9600,15700,24000,
8400,19200,28700,27400,58100,17300,20200,63700,9100,18800,2900,14200,17700,
5100,3200,19500,21500,18800,18000,10300,9500,18400,20100,2000,20600,29500,18900,
14100,19000,7600,4700,8900,23100,21100,14800,17800,6500,15500,9500,27600,12200,
9900,37000,4900,10400,18500,8800,14700,7400,8600,11500,15800,34200,9900,10500,
3500,18000,21200,19900,5100,14500,10900,17700,18200,10600,13000,16300,12100,
31400,24200,11600,16100,9600,32000,7800,23000,18500,18500,16500,10500,11700,
16800,17900,13000,17400,9400,10200,13800,21600,10800,16500,14400,17900,7400,
16000,4400,16400,15100,13500,16400,14300,20400,5200,53400,32300,37700,18800,
42800,2800,26900,32800,19000,25800,18700,37800,32700,18200,22100,10000,2000,
7700,26800,8400,19800,12300,39000,22800,16200,21100,11000,17000,9200,7800,10600,
33100,18400,7500,14100,14300,39000,10700,12700,12700,12300,19700,5800,11600,
14600,10700,19000,20700,12600,17300,72400,62700,15000,15500,8900,15700,14100,
11300,17600,10100,21200,14300,14500,7900,40000,22800,11900,11600,7300,15600,
4500,13700,8300,12600,39400,20400,9700,11500,15000,20000,8800,9100,7300,20300,
18100,11900,17100,11200,21500,6300,11500,12100,20300,23800,14000,24400,19600,
6800,24100,4700,1200,23700,6300,13700,33800,23900,3900,13900,34300,24200,5700,
24800,9500,6700,13100,22700,800,11600,23700,29000,23500,10700,4500,8200,3500,
6000,6000,9300,4900,5900,32400,3400,22700,7000,5500,10500,25000,3800,27300,6000,
6600,21300,6800,12200,11900,22100,17400,18400,16100,19600,10500,14500,20000,20500,
21400,15500,14900,16100,5100,16300,12300,13100,26800,20000,21500,25000,20400,39400,
17300,11300,23300,20500,9900,14000,12400,14900,4200,23700,38500,14300,15400,8800,
33300,13100,18200,26000,40600,37400,10800,35200,20300,16600,44000,25700,36600,
24800,12300,4500,13200,16600,10300,12400,10700,19900,12500,7600,12500,15600,24700,
3900,15500,10700,21200,18700,19200,14700,39900,9500,23800,38600,19500,20900,10600,
25300,8600,23100,28000,24400,24200,22100,26200,37800,18700,47300,13700,27500,20800,
11700,10100,19400,32700,9000,2400,43100,31600,22500,33900,22400,20900,11200,11100,
25700,8700,8400,13700,19600,27300,8600,39500,6300,23700,14100,34900,13000,13300,20900,8600,
24500,16600,36500,11700,9700,18900,11100,12400,17400,11400,18200,25400,26600,24800,
19500,37300,18900,16500,13100,16100,16000,11500,10200,6600,23100,8500,17100,13000,41700,18200,
18800,14500,34100,14500,6800,12800,7700,16600,21800,25500,6900,26800,14300,6900,21700,10800,
13100,15300,23900,18300,7700,16100,9700,9000,36700,8600,19800,22600,28900,10500,
9300,21400,20300,11800,11400,5000,14400,20600,14600,21700,56800,15700,18400,33700,15000,15900,
21100,19600,17300,19700,12500,15500,12800,22800,15900,14800,16700,12500,59900,37000,18400,
18800,19500,21900,11100,33900,32100,34400,31800,9900,6500,23600,13500,14200,16400,16700,23700,
10400,16200,18800,22200,37700,13000,21700,16000,28900,42200,19200,21200,24200,13000,
17100,22700,21300,25300,32100,33000,27200,26100,32200,17600,43000,20000,30500,24900,
35200,24800,13000,21300,14400,25000,8900,38700,26000,20300,22100,20400,31500,14100,
13800,33500,25400,16800,13400,14500,10700,23400,35100,6000,6300,36000,41900,15800,
8300,19300,18800,6400,26200,29900,16300,20700,30100,8200,20100,14200,4600,29900,
13200,44000,24200,21800,15200,18500,16800,23600,18700,16200,23000,4400,17700,2100,
15100,30200,14500,29800,22700,7600,8800,22300,13200,11900,5700,29300,16900,9400,
18800,23800,7100,15600,23200,8000,30400,9800,24100,11300,21600,5900,16400,8600,14100,
33200,30300,8900,10300,20000,16500,26500,17400,39400,6500,16300,19200,6500,20500,
35500,16400,20500,19300,12200,21600,14800,13800,13500,23800,17400,11300,23900,23200,
15000,16600,13400,53800,21400,32500,36000)

# ------------------------------------------------------------
# Joint Visualization Layout
# ------------------------------------------------------------
# Combined layout showing:
# - Scatterplot of temperature vs vehicle volume
# - Histogram of temperature
# - Boxplot of vehicle volume

layout(matrix(c(2, 0, 1, 3),
              nrow = 2,
              byrow = TRUE),
       widths = c(2, 1),
       heights = c(2, 2),
       respect = TRUE)

xlim = range(temp2) * 1.1

plot(veh_vol2 ~ temp2,
     xlim = xlim)

hist(temp2,
     main = "",
     xlim = xlim)

boxplot(veh_vol2)


# ------------------------------------------------------------
# Convex Hull Analysis
# ------------------------------------------------------------
# Convex hull is used to identify extreme boundary points
# (potential influential observations).

hull = chull(temp2, veh_vol2)

plot(temp2, veh_vol2,
     pch = 1,
     xlab = "Max Temperature",
     ylab = "Vehicle Volume")

polygon(temp2[hull],
        veh_vol2[hull],
        density = 15,
        angle = 30)


# ------------------------------------------------------------
# Correlation Analysis
# ------------------------------------------------------------
# Correlation is calculated:
# 1) Including all data
# 2) Excluding convex hull points to assess influence

cor(temp2[-hull], veh_vol2[-hull])
cor(temp2, veh_vol2)


# ------------------------------------------------------------
# Spearman Rank Correlation Test
# ------------------------------------------------------------
# A nonparametric measure of association is used to account for
# nonlinearity and potential outliers.

cor.test(temp2, veh_vol2, method = "spearman")